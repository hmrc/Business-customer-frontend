@*
 * Copyright 2020 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import play.twirl.api.HtmlFormat
@import layouts.{govuk_template => hmrcGovUkTemplate}
@import uk.gov.hmrc.play.views.html.{layouts => uiLayouts}
@import uk.gov.hmrc.play.views.html.{helpers => uiHelpers}
@import config._

@(applicationConfig: ApplicationConfig,
    supportLinkEnabled: Boolean = false,
    title: String,
    sidebarLinks: Option[Html] = None,
    sidebarClass: Option[String] = None,
    service: String = "",
    contentHeader: Option[Html] = None,
    userLoggedIn: Boolean = false,
    scriptElement: Option[Html] = None,
    linkElement : Option[Html] = None
    )(mainContent: Html = HtmlFormat.empty)(implicit request : Request[_], messages: Messages, appConfig: ApplicationConfig)

@head = {
  @uiLayouts.head(
  linkElem = linkElement,
  headScripts = None)

  <meta name="format-detection" content="telephone=no" />

  @views.html.helpers.ga(applicationConfig.analyticsToken.getOrElse("UA-123456"))
}

@headerNavLinks = {
  @if(userLoggedIn) {
    <li><a id="logOutNavHref" href='@routes.ApplicationController.logout(service)'>@messages("bc.sign-out")</a></li>
  }
}

@article = {
  @uiLayouts.article(content = mainContent, includeGridWrapper = false, articleClasses = None)
}

@sidebar = {
    @uiLayouts.sidebar(sidebarLinks = sidebarLinks.fold(HtmlFormat.empty)(x=>x), sidebarClass = sidebarClass)
}

@insideHeader = {
  @uiLayouts.header_nav(
  navTitle = applicationConfig.getNavTitle(service).map(s => messages(s)),
  navTitleLink = None,
  showBetaLink = false,
  navLinks = Some(headerNavLinks))
}

@afterHeader = {}

@bodyEnd = {
  @uiLayouts.footer(
  analyticsToken = applicationConfig.analyticsToken,
  analyticsHost = applicationConfig.analyticsHost,
  ssoUrl = None,
  scriptElem = scriptElement,
  gaCalls = None)
}

@footerTop = {}
@footerLinks = {}


@serviceInfo = {
  @uiLayouts.serviceInfo(
  betaBanner = HtmlFormat.empty,
  includeGridWrapper = false,
  serviceInfoContent = None,
  includeHMRCBranding = false)
}

@getHelpForm = {
  @if(supportLinkEnabled) {
    @{uiHelpers.reportAProblemLink(applicationConfig.reportAProblemPartialUrl, applicationConfig.reportAProblemNonJSUrl)}
  }
}

@mainContentHeader = {
  @if(contentHeader.isDefined) {
    @uiLayouts.main_content_header(contentHeader = contentHeader.get)
  }
}


@content = {
  @uiLayouts.main_content(
  article = article,
  sidebar = sidebar,
  mainContentHeader = mainContentHeader,
  serviceInfo = serviceInfo,
  getHelpForm = getHelpForm)
}

@hmrcGovUkTemplate(title = Some(s"$title - GOV.UK"), bodyClasses = None)(head = head,
    bodyEnd = bodyEnd,
    insideHeader = insideHeader,
    afterHeader = afterHeader,
    footerTop = footerTop,
    footerLinks = Some(uiLayouts.footer_links()),
    nav = true)(content = content)