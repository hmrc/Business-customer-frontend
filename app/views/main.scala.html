@*
 * Copyright 2020 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import config._
@import layouts.{GovUkTemplate, govuk_template => hmrcGovUkTemplate}
@import play.twirl.api.HtmlFormat
@import uk.gov.hmrc.play.views.html.helpers.ReportAProblemLink
@import uk.gov.hmrc.play.views.html.layouts._

@this(
    govuk_template: GovUkTemplate,
    layoutHead: Head,
    betaBanner: BetaBanner,
    layoutServiceInfo: ServiceInfo,
    reportAProblemLink: ReportAProblemLink,
    layoutArticle: Article,
    main_content_header: MainContentHeader,
    main_content: MainContent,
    footer: Footer,
    footer_links: FooterLinks,
    header_nav: HeaderNav,
    referrer: String
)

@(applicationConfig: ApplicationConfig,
    supportLinkEnabled: Boolean = false,
    title: String,
    sidebarLinks: Option[Html] = None,
    sidebarClass: Option[String] = None,
    service: String = "",
    contentHeader: Option[Html] = None,
    userLoggedIn: Boolean = false,
    scriptElement: Option[Html] = None,
    linkElement : Option[Html] = None,
    referrer: String = ""
    )(mainContent: Html = HtmlFormat.empty)(implicit request : Request[_], messages: Messages, appConfig: ApplicationConfig)

@head = {
  @layoutHead(
  linkElem = linkElement,
  headScripts = None)

  <meta name="format-detection" content="telephone=no" />

  @views.html.helpers.ga(applicationConfig.analyticsToken.getOrElse("UA-123456"))
}

@headerNavLinks = {
  @if(userLoggedIn) {
    <li><a id="logOutNavHref" href='@routes.ApplicationController.logout(service)'>@messages("bc.sign-out")</a></li>
  }
}

@article = {
  @layoutArticle(content = mainContent, includeGridWrapper = false, articleClasses = None)
}

@sidebar = {
    <div class="side-bar">
        @sidebarLinks
    </div>
}

@insideHeader = {
  @header_nav(
  navTitle = applicationConfig.getNavTitle(service).map(s => messages(s)),
  navTitleLink = None,
  showBetaLink = false,
  navLinks = Some(headerNavLinks))
}

@afterHeader = {}

@bodyEnd = {
  @footer(
  analyticsToken = applicationConfig.analyticsToken,
  analyticsHost = applicationConfig.analyticsHost,
  ssoUrl = None,
  scriptElem = scriptElement,
  gaCalls = None)
}

@footerTop = {}

@serviceInfo = {
  @layoutServiceInfo(
  betaBanner = HtmlFormat.empty,
  includeGridWrapper = false,
  serviceInfoContent = None,
  includeHMRCBranding = false)
}

@getHelpForm = {
  @if(supportLinkEnabled) {
    @{reportAProblemLink(applicationConfig.reportAProblemPartialUrl, applicationConfig.reportAProblemNonJSUrl)}
  }
}

@mainContentHeader = {
  @if(contentHeader.isDefined) {
    @main_content_header(contentHeader = contentHeader.get)
  }
}


@content = {
  @main_content(
  article = article,
  sidebar = sidebar,
  mainContentHeader = mainContentHeader,
  serviceInfo = serviceInfo,
  getHelpForm = getHelpForm)
}

@footerLinks = {
    @footer_links(accessibilityFooterUrl = Some(applicationConfig.accessibilityStatementFrontendUrl(service, referrer)))
}

@hmrcGovUkTemplate(title = Some(s"$title - GOV.UK"), bodyClasses = None)(
    head = head,
    bodyEnd = bodyEnd,
    insideHeader = insideHeader,
    afterHeader = afterHeader,
    footerTop = footerTop,
    footerLinks = Some(footerLinks),
    nav = true)(content = content)